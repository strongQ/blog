import{C as T,a as M,g,c as w,e as b,M as q,V as B,T as L,d as N}from"./chunks/XYZ.00767a0c.js";import{O as V}from"./chunks/OSM.c6e7868c.js";import{d as k,h as W,j as P,o as v,c as E,_ as U,E as O,J as S,w as I,U as x}from"./chunks/framework.83a19234.js";const u="units",$=[1,2,5],C=25.4/.28;class R extends T{constructor(s){s=s||{};const e=document.createElement("div");e.style.pointerEvents="none",super({element:e,render:s.render,target:s.target}),this.on,this.once,this.un;const l=s.className!==void 0?s.className:s.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=l+"-inner",this.element.className=l+" "+M,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=s.minWidth!==void 0?s.minWidth:64,this.maxWidth_=s.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(u,this.handleUnitsChanged_),this.setUnits(s.units||"metric"),this.scaleBar_=s.bar||!1,this.scaleBarSteps_=s.steps||4,this.scaleBarText_=s.text||!1,this.dpi_=s.dpi||void 0}getUnits(){return this.get(u)}handleUnitsChanged_(){this.updateElement_()}setUnits(s){this.set(u,s)}setDpi(s){this.dpi_=s}updateElement_(){const s=this.viewState_;if(!s){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=s.center,l=s.projection,o=this.getUnits(),F=o=="degrees"?"degrees":"m";let a=g(l,s.resolution,e,F);const c=this.minWidth_*(this.dpi_||C)/C,r=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||C)/C:void 0;let t=c*a,n="";if(o=="degrees"){const d=b.degrees;t*=d,t<d/60?(n="″",a*=3600):t<d?(n="′",a*=60):n="°"}else o=="imperial"?t<.9144?(n="in",a/=.0254):t<1609.344?(n="ft",a/=.3048):(n="mi",a/=1609.344):o=="nautical"?(a/=1852,n="NM"):o=="metric"?t<.001?(n="μm",a*=1e6):t<1?(n="mm",a*=1e3):t<1e3?n="m":(n="km",a/=1e3):o=="us"?t<.9144?(n="in",a*=39.37):t<1609.344?(n="ft",a/=.30480061):(n="mi",a/=1609.3472):w(!1,33);let D=3*Math.floor(Math.log(c*a)/Math.log(10)),i,p,y,m,A,f;for(;;){y=Math.floor(D/3);const d=Math.pow(10,y);if(i=$[(D%3+3)%3]*d,p=Math.round(i/a),isNaN(p)){this.element.style.display="none",this.renderedVisible_=!1;return}if(r!==void 0&&p>=r){i=m,p=A,y=f;break}else if(p>=c)break;m=i,A=p,f=y,++D}const h=this.scaleBar_?this.createScaleBar(p,i,n):i.toFixed(y<0?-y:0)+" "+n;this.renderedHTML_!=h&&(this.innerElement_.innerHTML=h,this.renderedHTML_=h),this.renderedWidth_!=p&&(this.innerElement_.style.width=p+"px",this.renderedWidth_=p),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(s,e,l){const o=this.getScaleForResolution(),F=o<1?Math.round(1/o).toLocaleString()+" : 1":"1 : "+Math.round(o).toLocaleString(),a=this.scaleBarSteps_,c=s/a,r=[this.createMarker("absolute")];for(let n=0;n<a;++n){const D=n%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";r.push(`<div><div class="ol-scale-singlebar ${D}" style="width: ${c}px;"></div>`+this.createMarker("relative")+(n%2===0||a===2?this.createStepText(n,s,!1,e,l):"")+"</div>")}return r.push(this.createStepText(a,s,!0,e,l)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${s}px;">`+F+"</div>":"")+r.join("")}createMarker(s){return`<div class="ol-scale-step-marker" style="position: ${s}; top: ${s==="absolute"?3:-10}px;"></div>`}createStepText(s,e,l,o,F){const c=(s===0?0:Math.round(o/this.scaleBarSteps_*s*100)/100)+(s===0?"":" "+F),r=s===0?-3:e/this.scaleBarSteps_*-1,t=s===0?0:e/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${r}px;text-align: ${s===0?"left":"center"};min-width: ${t}px;left: ${l?e+"px":"unset"};">`+c+"</div>"}getScaleForResolution(){const s=g(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),e=this.dpi_||C,l=1e3/25.4;return s*l*e}render(s){const e=s.frameState;e?this.viewState_=e.viewState:this.viewState_=null,this.updateElement_()}}const j=R,H=k({__name:"scale",setup(_){const s=W();return P(()=>{new q({view:new B({center:[12579156,3274244],zoom:12}),layers:[new L({source:new V})],controls:N().extend([new j]),target:s.value})}),(e,l)=>(v(),E("div",{ref_key:"map",ref:s,class:"map-example"},null,512))}});const z=U(H,[["__scopeId","data-v-0ce07608"]]),G=x("",2),J=x("",1),Z=JSON.parse('{"title":"openlayers 比例尺","description":"","frontmatter":{},"headers":[],"relativePath":"docs/框架/openlayers示例/地图控件/比例尺.md","filePath":"docs/框架/openlayers示例/地图控件/比例尺.md","lastUpdated":1706152240000}'),K={name:"docs/框架/openlayers示例/地图控件/比例尺.md"},ss=Object.assign(K,{setup(_){return(s,e)=>{const l=O("ClientOnly");return v(),E("div",null,[G,S(l,null,{default:I(()=>[S(z)]),_:1}),J])}}});export{Z as __pageData,ss as default};
